<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>joe di castro - Ubuntu</title>
  <meta name="author" content="joe di castro" />
  <meta name="keywords" content="joe di castro, blog">
  <link rel="author" href="humans.txt" />
  <link rel="stylesheet" href=".././theme/css/main.css" type="text/css" />
  <link href=".././atom.xml" type="application/atom+xml" rel="alternate" title="joe di castro ATOM Feed" />
  <link href=".././rss.xml" type="application/atom+xml" rel="alternate" title="joe di castro RSS Feed" />
  
  <link href=".././feeds/tags/Ubuntu.atom.xml" type="application/atom+xml" rel="alternate" title="joe di castro - Ubuntu ATOM Feed" />
  <link href=".././feeds/tags/Ubuntu.rss.xml" type="application/atom+xml" rel="alternate" title="joe di castro - Ubuntu RSS Feed" />

  <!--[if IE]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>
<body id="index" class="home">

  <header id="banner" class="body">
    <h1><a href="../."><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAAAxBAMAAADKNk2HAAAAElBMVEW/kiXQsGLey5vn3b/s5dH3+fXlDfF2AAADFElEQVRIDa3Bu3LbOABA0QtQ7KFo0TPOqmfiZU/PmD1A8v7/r6yejpPIkxlL5+BP85aQ/Ty8WhJH2U/Dixl2ky80fhqeVaJHI34answ0nlS8bR38GzwhejYzeFPK/g0ejUyezUzesuBHusEzPFjIXlS8qTR+YMYLPOiDVwVvStkPjBsvUFdar0rwlgU/wt4L1IJvusZbSuMHanh9nTxB7aNvaL0lZX8z86tJUVPj1cLeG2b8Xd1ut09P337w3+vr8/PzNxU1Ra8K3jJu/ECJvkHt2T151kdvYe8HUvYNaoXgGa03VJy84dkZf8KDeTd5MrP3hr6t0T+Nwb519QrfK3jDyj5l/8RGhgWv8L2u8c3kVQkuvrc8eVAZSrALXuF7ZJ3j10m/gyfLtk2tF2tirz1kNW1M7Urrwcvui+I7FV2A1gTBowpbhpfBkxRS60hkryPDgoWp0woM4jt9XDsIqe3Zd3snXYh2YWXwqA8L+4V/1qALWKJ96IJCZFrwHQIHmSeyOm40RWfaEj2qDH00RUujXcSUTdA6wgtzwJ9mCClQSXEdXBmsaGIi22dN2TR0TJKtoYQFa9gyrdD0kYxv1sRupoSOg439RlNrJc44ozWoldYRV3LZlGjKJTqG1EAjXi3QOm4K8IMwVXRlWKEdW1OrXdYVpoXWFE1tynMw5ZWcICheLMBkGhbiVBkkaw12MDHUoCtqR2NiGPke2TF0ecEeCzsVz1ZCH1xxZDC1do1a4gt9nMPMoLXRnpR7qLQpMfIlWDaVxhQ8wLMUJloXOrIVx+BBgZzaGslqaX1hk7Z0sFkhdiFl+0CKicEDPOkZKpNC1NK8sPeg0qwMM40HJXZEO3IhusDA16A9TYXsER5Vsn1U571aYOPJq3PUV49miLoMzkFddEpZHfTH5Ake0SjZi4WdN3z/11998Vd4MDJZ8F6oC1nTxnuh9kFn9t4LXcg6Bu+GjkGl9W4orVYm74aVSVPj/bCLOrP3fkjWPvgAVHQl+wCUqAUfga5VWh8BsgUfAvJK60NAk/AxSJB9DEY2Psj/Dz0Ida72jQIAAAAASUVORK5CYII=" alt="joe di castro" title="joe di castro" width="150" height="49" /> </a></h1>
      <nav>
      	<ul>
         
         <li ><a href=".././category/blog.html">blog</a></li>
         <li><a href=".././archives.html">archivos</a></li>
         <li><a href=".././tags.html">etiquetas</a></li>
         
         <li><a href=".././pages/markdown.html">markdown</a></li><li><a href=".././pages/sobre-mi.html">sobre mi</a></li>
         
       </ul>
     </nav>
  </header><!-- /#banner -->        

          
    
    
    <aside id="featured" class="body">
      <article>
        <h1 class="entry-title"><a href=".././notificaciones-de-escritorio-en-ubuntu-desde-python.html">Notificaciones de escritorio en Ubuntu desde Python</a></h1> 
        <p>En <strong>Ubuntu</strong><sup id="fnref:1"><a href="#fn:1" >1</a></sup> las notificaciones de escritorio son esos <strong>cuadros
emergentes</strong> que nos proporcionan información sobre algún evento que se está
produciendo en nuestro equipo (llegada de un email, canción que se está
reproduciendo, cambio de volumen, estado de batería, etc). Sustituyen a las
ventanas de dialogo que normalmente requieren la intervención del usuario para
cerrarlas y son más molestas. Además frente a las ventanas de dialogo tienen la
gran ventaja de que son gestionadas a través de una cola. Es decir, que si hay
varias notificaciones para mostrar, no se muestran todas a la vez llenándote
todo el escritorio de pequeñas ventanas, se van mostrando una después de otra.
La notificaciones aparecen en una esquina del escritorio y se desvanecen por si
solas al cabo de unos segundos. Son muy útiles porque llaman nuestra atención y
nos informan sin interrumpir nuestro trabajo.</p>
<p style="text-align:center;"><img src="../static/pictures/notify_example.png" width="366"
 height="147" alt="notify_example.png" title="Ejemplo de notificación"/></p>

<p>En Ubuntu esta operación la realiza el paquete <a href="https://launchpad.net/notify-osd">Notify OSD</a> que se basa en
las especificaciones del proyecto <a href="http://www.galago-project.org/about.php">Galago</a> (<a href="http://www.galago-project.org/specs/notification/0.9/">freedesktop.org Desktop
Notifications Specification</a>). Este emplea el demonio <em>notify-osd</em> para
enviar las notificaciones a través de <a href="http://www.freedesktop.org/wiki/Software/dbus">D-Bus</a>. Sin embargo muchos paquetes
aún emplean la librería <strong>libnotify</strong> del proyecto Galago para enviar sus
notificaciones. Además el proyecto Galago tiene un <a href="http://es.wikipedia.org/wiki/Binding">binding</a> para <strong>Python</strong>
de está librería, que es lo que emplearé en este artículo. En Ubuntu, es el
paquete <a href="http://packages.ubuntu.com/es/natty/i386/python-notify">python-notify</a> y se importa desde Python como <code>pynotify</code>. También
es posible emplear el paquete <a href="http://packages.ubuntu.com/natty/libnotify-bin">libnotify-bin</a> que nos proporciona el comando
<code>notify-send</code> que nos permite enviar notificaciones directamente desde la línea
de comandos, algo que puede ser muy útil para scripts en <a href="http://es.wikipedia.org/wiki/Bash"><em>bash</em></a>.</p>
<p>Ejemplo de utilización de <code>notify-send</code>:</p>
<div class="codehilite"><pre><span class="nv">$ </span>notify-send <span class="s2">&quot;Notificación&quot;</span> <span class="s2">&quot;Esto es un ejemplo de notificación&quot;</span>
</pre></div>


<p>que nos mostraría una notificación como esta:</p>
<p style="text-align:center;"><img src="../static/pictures/notify_send.png" width="341"
height="84" alt="notify_send.png" /></p>

<h3 id="notificaciones_desde_python">Notificaciones desde Python</h3>
<p>Empleando <code>pynotify</code> podemos emplear estas notificaciones en nuestros programas
y scripts Python y se visualizaran igual que las propias del sistema. El
problema que tiene este modulo es que no tiene documentación <abbr title="As Far As I Know (en español &quot;Hasta donde yo sé&quot; o &quot;Que yo sepa&quot;)">AFAIK</abbr>, por lo que
tenemos que guiarnos por algunos ejemplos (los del <a href="http://www.galago-project.org/downloads.php">propio paquete</a>, por
ejemplo) o experimentar con él ayudándonos de las herramientas de introspección
de Python (<code>help()</code>, <code>dir()</code>, <a href="http://docs.python.org/library/inspect.html">inspect</a>).</p>
<p>Para poder emplearlo en mis programas he creado una función que hace uso de las
opciones principales de las notificaciones:</p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">pynotify</span>
<span class="kn">import</span> <span class="nn">gtk</span>

<span class="k">def</span> <span class="nf">notify</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Send notification icon messages through libnotify.</span>

<span class="sd">    Parameters:</span>

<span class="sd">    (str) title -- The notification title</span>
<span class="sd">    (str) msg -- The message to display into notification</span>
<span class="sd">    (str / uri) icon -- Type of icon (ok|info|error|warm|ask|sync) or icon file</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pynotify</span><span class="o">.</span><span class="n">is_initted</span><span class="p">():</span>
        <span class="n">pynotify</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">gtk_icon</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;ok&#39;</span><span class="p">:</span><span class="n">gtk</span><span class="o">.</span><span class="n">STOCK_YES</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span><span class="n">gtk</span><span class="o">.</span><span class="n">STOCK_DIALOG_INFO</span><span class="p">,</span>
                <span class="s">&#39;error&#39;</span><span class="p">:</span><span class="n">gtk</span><span class="o">.</span><span class="n">STOCK_DIALOG_ERROR</span><span class="p">,</span> <span class="s">&#39;warm&#39;</span><span class="p">:</span><span class="n">gtk</span><span class="o">.</span><span class="n">STOCK_DIALOG_WARNING</span><span class="p">,</span>
                <span class="s">&#39;ask&#39;</span><span class="p">:</span><span class="n">gtk</span><span class="o">.</span><span class="n">STOCK_DIALOG_QUESTION</span><span class="p">,</span> <span class="s">&#39;sync&#39;</span><span class="p">:</span><span class="n">gtk</span><span class="o">.</span><span class="n">STOCK_JUMP_TO</span><span class="p">}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">note</span> <span class="o">=</span> <span class="n">pynotify</span><span class="o">.</span><span class="n">Notification</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="n">helper</span> <span class="o">=</span> <span class="n">gtk</span><span class="o">.</span><span class="n">Button</span><span class="p">()</span>
        <span class="n">gtk_icon</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">render_icon</span><span class="p">(</span><span class="n">gtk_icon</span><span class="p">[</span><span class="n">icon</span><span class="p">],</span> <span class="n">gtk</span><span class="o">.</span><span class="n">ICON_SIZE_BUTTON</span><span class="p">)</span>
        <span class="n">note</span><span class="o">.</span><span class="n">set_icon_from_pixbuf</span><span class="p">(</span><span class="n">gtk_icon</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">note</span> <span class="o">=</span> <span class="n">pynotify</span><span class="o">.</span><span class="n">Notification</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">icon</span><span class="p">)</span>
    <span class="n">note</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<p>Básicamente llamamos a la función y le decimos que titulo le queremos poner, el
mensaje y el icono que queremos mostrar. En cuanto al icono se puede emplear
ninguno, uno personalizado indicando la ruta al fichero o un icono estándar de
GTK para las opciones más comunes. Veamos lo sencillo de su funcionamiento con
ejemplos:</p>
<div class="codehilite"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Notificación sin icono</span>
<span class="gp">... </span><span class="n">notify</span><span class="p">(</span><span class="s">&quot;Titulo&quot;</span><span class="p">,</span> <span class="s">&quot;Esta notificación no lleva icono&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>


<p style="text-align:center;"><img src="../static/pictures/notify_noicon.png" width="339"
height="87" alt="notify_noicon.png" /></p>

<div class="codehilite"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Notificación con icono personalizado</span>
<span class="gp">... </span><span class="n">notify</span><span class="p">(</span><span class="s">&quot;Ubuntu&quot;</span><span class="p">,</span> <span class="s">&quot;Esta lleva el icono personalizado&quot;</span><span class="p">,</span>
<span class="go">&quot;/usr/share/icons/gnome/scalable/places/ubuntu-logo.svg&quot;)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>


<p style="text-align:center;"><img src="../static/pictures/notify_ubuntu.png" width="339"
height="87" alt="notify_ubuntu.png" /></p>

<div class="codehilite"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Notificación de información (GTK)</span>
<span class="gp">... </span><span class="n">notify</span><span class="p">(</span><span class="s">&quot;Información&quot;</span><span class="p">,</span> <span class="s">&quot;Esta emplea el icono de información estándar de GTK&quot;</span><span class="p">,</span> <span class="s">&quot;info&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>


<p style="text-align:center;"><img src="../static/pictures/notify_info.png" width="339"
height="87" alt="notify_info.png" /></p>

<div class="codehilite"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Notificación de error (GTK)</span>
<span class="gp">... </span><span class="n">notify</span><span class="p">(</span><span class="s">&quot;Error!&quot;</span><span class="p">,</span> <span class="s">&quot;Ejemplo de reporte de error (GTK)&quot;</span><span class="p">,</span> <span class="s">&quot;error&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>


<p style="text-align:center;"><img src="../static/pictures/notify_error.png" width="338"
height="87" alt="notify_error.png" /></p>

<p>Como se puede ver el proceso es realmente sencillo y hacer esto puede aportar a
nuestros programas/scripts ese toque que le faltaba y que tanto contribuye a la
usabilidad de los mismos. Yo por ejemplo, lo empleo en scripts programados para
saber cuando se activan y cuando terminan, sobre todo cuando son procesos
largos. Un ejemplo puede verse en el código de <a href="../static/sincronizar-una-carpeta-local-y-una-remota-a-traves-de-ftp-lftp-mirror.html">Sincronizar una carpeta local y
una remota a través de FTP: lftp-mirror</a></p>
<p>El fichero con este código, <a href="https://bitbucket.org/joedicastro/python-recipes/src/tip/src/notify.py">notify.py</a> se encuentra en
<a href="https://bitbucket.org/joedicastro/python-recipes">mi repositorio</a>.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>Se puede emplear también en otras distribuciones Linux
&#160;<a href="#fnref:1"  title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
        <p>Hay <a href=".././notificaciones-de-escritorio-en-ubuntu-desde-python.html#disqus_thread">comentarios</a>.</p>
      </article>
      
    </aside><!-- /#featured -->
      
      <section id="content" class="body">
        <h1>Otros articulos</h1>
        <hr />
        <ol id="posts-list" class="hfeed">
      
    
    
    
        
    
     
      
            <li>
              <article class="hentry">    
                <header>
                  <h1><a href=".././generar-informes-de-cambios-en-paquetes-instalados-en-debian-y-ubuntu.html" rel="bookmark" title="Permalink a Generar informes de cambios en paquetes instalados en Debian y Ubuntu.">Generar informes de cambios en paquetes instalados en Debian y Ubuntu.</a></h1>
                </header> 
                <div class="entry-content">
                  <p>Una de las políticas de seguridad que tengo con mis sistemas <strong>Linux</strong>, es 
además de efectuar respaldos periódicos (diarios) del contenido del directorio 
<code>/home</code> (en mi caso siempre es una partición o disco independiente), es siempre 
guardar también una lista de los <abbr title="En sistemas *NIX se denomina así a los programas">paquetes</abbr> instalados en los mismos. 
Prácticamente nunca hago ...</p>
                  <a class="readmore" href=".././generar-informes-de-cambios-en-paquetes-instalados-en-debian-y-ubuntu.html">leer más</a>
                  <p>Hay <a href=".././generar-informes-de-cambios-en-paquetes-instalados-en-debian-y-ubuntu.html#disqus_thread">comentarios</a>.</p>
                </div><!-- /.entry-content -->
              </article></li>
    
    
      <li id="paginator">
  
  Pagina 1 de 1
  
</li>
    

    
     </ol><!-- /#posts-list -->
    </section><!-- /#content -->


<section id="extras" class="body">
    
    <div class="blogroll">
      <h2>enlaces</h2>
        <ul>
          <li><a href="http://photo.joedicastro.com/">Fotografías</a></li>
          <li><a href="http://code.joedicastro.com/">Código</a></li>
          <li><a href="http://python.majibu.org/">python majibu</a></li>
          <li><a href="http://python-hispano.org/">python hispano</a></li>
          <li><a href="http://planet.python-hispano.org/">planeta python hispano</a></li>
        </ul>
    </div><!-- /.blogroll -->
    
    
    <div class="social">
      <h2>social</h2>
        <ul>
          <li><a href=".././atom.xml" rel="alternate">atom</a></li>
          <li><a href=".././rss.xml" rel="alternate">rss</a></li>
          
          <li><a href="http://twitter.com/joe_di_castro">twitter</a></li>
          <li><a href="http://identi.ca/joedicastro">identi.ca</a></li>
          <li><a href="http://www.facebook.com/joedicastr0">facebook</a></li>
          <li><a href="https://bitbucket.org/joedicastro">bitbucket</a></li>
        </ul>
    </div><!-- /.social -->
    
  </section><!-- /#extras -->
  <footer id="contentinfo" class="body">
    <address id="about" class="vcard body">
      © 2010-2011 joe di castro. Powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a><span id="license">Los contenidos están bajo una <a href="http://creativecommons.org/licenses/by-sa/3.0/es">licencia Creative Commons</a></span>
    </address><!-- /#about -->
  </footer><!-- /#contentinfo -->

  <script type="text/javascript">
    
        var pkBaseURL = (("https:" == document.location.protocol) ? "https://joedicastro.com/piwik/" : "http://joedicastro.com/piwik/");
    
    document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
    </script><script type="text/javascript">
    try {
    var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 1);
    piwikTracker.trackPageView();
    piwikTracker.enableLinkTracking();
    } catch( err ) {}
  </script><noscript><p><img src="http://joedicastro.com/piwik/piwik.php?idsite=1" style="border:0" alt="" /></p></noscript>


<script type="text/javascript">
    var disqus_shortname = 'joedicastro';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

</body>
</html>